!function(){function e(){var e,n=_.extend({},Object.getPrototypeOf(this),this.constructor.__super__);for(var o in n)n.hasOwnProperty(o)&&(e=n[o],e instanceof Backbone.Computed&&t(this,e,o))}"undefined"!=typeof exports&&(_=require("underscore"),Backbone=require("backbone")),Backbone.Computed=function(e){return this instanceof Backbone.Computed?(e=Array.prototype.slice.call(e,0),this.computedFunction=e[e.length-1],this.dep=e.slice(0,-1),void 0):new Backbone.Computed(arguments)},Backbone.Computed.prototype.getDependentProperties=function(){return this.dep};var n=Backbone.Model;Backbone.Model=n.extend({constructor:function(){n.apply(this,arguments),e.call(this)}});var t=function(e,n,t){var o=function(){e.set(t,n.computedFunction.call(e))},r=_.memoize(function(){return _.filter(n.getDependentProperties(),function(e){return e.indexOf("event:")<0})}),i=_.memoize(function(){return _.chain(n.getDependentProperties()).filter(function(e){return 0===e.indexOf("event:")}).map(function(e){return e.replace("event:","")}).value()}),u=function(){return r().map(function(e){return"change:"+e})},c=function(){if(r().length){var n=u().join(" ");e.on(n,o)}},a=function(){if(i().length){var n=i().join(" ");e.on(n,o)}};c(),a(),o()};"undefined"!=typeof exports&&(module.exports=Backbone.Computed)}();